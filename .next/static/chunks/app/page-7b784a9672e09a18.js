(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1394:(e,t,s)=>{"use strict";s.d(t,{BK:()=>d,eu:()=>i,q5:()=>o});var a=s(5155),r=s(2115),l=s(5977),n=s(9434);let i=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.bL,{ref:t,className:(0,n.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",s),...r})});i.displayName=l.bL.displayName;let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l._V,{ref:t,className:(0,n.cn)("aspect-square h-full w-full",s),...r})});d.displayName=l._V.displayName;let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.H4,{ref:t,className:(0,n.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",s),...r})});o.displayName=l.H4.displayName},2523:(e,t,s)=>{"use strict";s.d(t,{p:()=>n});var a=s(5155),r=s(2115),l=s(9434);let n=r.forwardRef((e,t)=>{let{className:s,type:r,...n}=e;return(0,a.jsx)("input",{type:r,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...n})});n.displayName="Input"},2751:(e,t,s)=>{Promise.resolve().then(s.bind(s,6589))},5057:(e,t,s)=>{"use strict";s.d(t,{J:()=>o});var a=s(5155),r=s(2115),l=s(968),n=s(2085),i=s(9434);let d=(0,n.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.b,{ref:t,className:(0,i.cn)(d(),s),...r})});o.displayName=l.b.displayName},6589:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>eU});var a=s(5155),r=s(2115),l=s(6104),n=s(5317);async function i(e){if(!e.id)return void console.error("Game must have an ID to be saved.");let{isGameActive:t,...s}=e;try{let e=await (0,n.gS)((0,n.rJ)(l.db,"games"),{...s,finishedAt:(0,n.O5)()});return console.log("Game result saved with ID: ",e.id),e.id}catch(e){console.error("Error adding document. Have you configured your .env.local file with your Firebase credentials?",e)}}async function d(){try{let e=(0,n.rJ)(l.db,"games"),t=(0,n.P)(e,(0,n.My)("finishedAt","desc"),(0,n.AB)(10)),s=await (0,n.GG)(t),a=[];return s.forEach(e=>{let t=e.data(),s=t.finishedAt;a.push({...t,id:e.id,isGameActive:!1,finishedAt:s?s.toDate().toISOString():new Date().toISOString()})}),a}catch(e){return console.error("Error fetching past games:",e),[]}}let o="bridgeScore_gameState",c=()=>({id:"",players:[],round:1,dealerIndex:0,phase:"calling",isGameActive:!1,totalRounds:10,winningScore:50}),m=(e,t)=>{let s=t.find(t=>t.totalScore>=e.winningScore),a=e.round+1,r=!!s||a>e.totalRounds;return{...e,players:t,round:a,dealerIndex:(e.dealerIndex+1)%e.players.length,phase:r?"finished":1===a?"making":"calling"}},u=(e,t)=>{switch(t.type){case"START_GAME":{let{players:e,winningScore:s,tag:a,hostId:r,hostName:l,hostPhotoURL:n}=t.payload,i=e.map((e,t)=>({id:"player-".concat(t+1),name:e,calls:Array(10).fill(null),made:Array(10).fill(null),scores:Array(10).fill(0),totalScore:0}));return{id:new Date().getTime().toString(),tag:a,players:i,round:1,dealerIndex:0,phase:"making",isGameActive:!0,totalRounds:10,winningScore:s,hostId:r,hostName:null!=l?l:void 0,hostPhotoURL:null!=n?n:void 0}}case"SET_CALLS":{let s=e.round-1,a=e.players.map((e,a)=>({...e,calls:e.calls.map((e,r)=>r===s?t.payload[a]:e)}));return{...e,players:a,phase:"making"}}case"SET_MADE":{if(1!==e.round)return e;let s=e.players.map((e,s)=>{let a=t.payload[s],r=[...e.scores];r[0]=8===a?13:a;let l=[...e.made];return l[0]=a,{...e,made:l,scores:r,totalScore:r.reduce((e,t)=>e+t,0)}});return m(e,s)}case"SET_OUTCOMES":{if(e.round<=1)return e;let s=e.round-1,a=e.players.map((e,a)=>{let r=e.calls[s],l=t.payload[a],n=0,i=null;null!==r&&("won"===l?(n=8===r?13:r,i=r):(n=-r,i=null));let d=[...e.scores];d[s]=n;let o=[...e.made];return o[s]=i,{...e,made:o,scores:d,totalScore:d.reduce((e,t)=>e+t,0)}});return m(e,a)}case"RESET_GAME":return c();case"LOAD_STATE":return t.payload;default:return e}},x=()=>{let[e,t]=(0,r.useReducer)(u,c()),s=(0,r.useRef)();(0,r.useEffect)(()=>{try{let e=localStorage.getItem(o);if(e){let a=JSON.parse(e);t({type:"LOAD_STATE",payload:a}),s.current=a}}catch(e){console.error("Failed to load game state from localStorage",e)}},[]),(0,r.useEffect)(()=>{if(e.isGameActive){var t;localStorage.setItem(o,JSON.stringify(e)),(null==(t=s.current)?void 0:t.phase)!=="finished"&&"finished"===e.phase&&e.hostId&&i(e)}else localStorage.removeItem(o);s.current=e},[e]);let a=(0,r.useCallback)((e,s,a,r,l,n)=>{t({type:"START_GAME",payload:{players:e,winningScore:s,tag:a,hostId:r,hostName:l,hostPhotoURL:n}})},[]),l=(0,r.useCallback)(e=>{t({type:"SET_CALLS",payload:e})},[]),n=(0,r.useCallback)(e=>{t({type:"SET_MADE",payload:e})},[]);return{gameState:e,startGame:a,setCalls:l,setMade:n,setOutcomes:(0,r.useCallback)(e=>{t({type:"SET_OUTCOMES",payload:e})},[]),resetGame:(0,r.useCallback)(()=>{t({type:"RESET_GAME"})},[])}};var f=s(9576),p=s(285),h=s(2523),g=s(5057),j=s(286),N=s(5268),y=s(7481);function b(e){let{startGame:t}=e,[s,l]=(0,r.useState)(["","","",""]),[n,i]=(0,r.useState)(""),[d,o]=(0,r.useState)("50"),{toast:c}=(0,y.dj)(),m=(e,t)=>{let a=[...s];a[e]=t,l(a)};return(0,a.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),s.some(e=>""===e.trim()))return void c({title:"Validation Error",description:"All four player names are required.",variant:"destructive"});if(4!==new Set(s.map(e=>e.trim())).size)return void c({title:"Validation Error",description:"Player names must be unique.",variant:"destructive"});let a=parseInt(d,10);if(isNaN(a)||a<=0)return void c({title:"Validation Error",description:"Winning score must be a positive number.",variant:"destructive"});t(s.map(e=>e.trim()),a,n.trim())},className:"space-y-6 pt-4",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)(g.J,{className:"font-semibold flex items-center gap-2",children:[(0,a.jsx)(j.A,{className:"w-4 h-4"}),"Player Names"]}),s.map((e,t)=>(0,a.jsx)(h.p,{type:"text",placeholder:"Player ".concat(t+1),value:e,onChange:e=>m(t,e.target.value),required:!0,className:"bg-white"},t))]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g.J,{htmlFor:"tag",className:"font-semibold",children:"Game Tag (Optional)"}),(0,a.jsx)(h.p,{id:"tag",type:"text",placeholder:"e.g. Friday Night Bridge",value:n,onChange:e=>i(e.target.value),className:"bg-white"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(g.J,{htmlFor:"winningScore",className:"font-semibold flex items-center gap-2",children:[(0,a.jsx)(N.A,{className:"w-4 h-4"}),"Winning Score"]}),(0,a.jsx)(h.p,{id:"winningScore",type:"number",placeholder:"e.g. 50",value:d,onChange:e=>o(e.target.value),className:"bg-white"})]}),(0,a.jsx)(p.$,{type:"submit",className:"w-full bg-accent hover:bg-accent/90 text-accent-foreground",children:"Start Game"})]})}var v=s(6695),w=s(2347),S=s(5318),A=s(4913),R=s(9434);let k=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{ref:t,className:(0,R.cn)("w-full caption-bottom text-sm",s),...r})})});k.displayName="Table";let E=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("thead",{ref:t,className:(0,R.cn)("[&_tr]:border-b",s),...r})});E.displayName="TableHeader";let C=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("tbody",{ref:t,className:(0,R.cn)("[&_tr:last-child]:border-0",s),...r})});C.displayName="TableBody",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("tfoot",{ref:t,className:(0,R.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...r})}).displayName="TableFooter";let T=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("tr",{ref:t,className:(0,R.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...r})});T.displayName="TableRow";let L=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("th",{ref:t,className:(0,R.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",s),...r})});L.displayName="TableHead";let I=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("td",{ref:t,className:(0,R.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",s),...r})});function _(e){let{players:t,totalRounds:s,currentRound:r,dealerIndex:l}=e,n=Array.from({length:s},(e,t)=>t+1),i=Math.max(...t.map(e=>e.totalScore));return(0,a.jsx)(v.Zp,{className:"shadow-lg",children:(0,a.jsx)(v.Wu,{className:"p-0",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(k,{children:[(0,a.jsx)(E,{children:(0,a.jsxs)(T,{children:[(0,a.jsx)(L,{className:"sticky left-0 bg-card z-10 min-w-[120px]",children:"Player"}),n.map(e=>(0,a.jsxs)(L,{className:(0,R.cn)("text-center",e===r&&"bg-secondary"),children:["Round ",e]},e)),(0,a.jsx)(L,{className:"text-center font-bold",children:"Total"})]})}),(0,a.jsx)(C,{children:t.map((e,t)=>(0,a.jsxs)(T,{children:[(0,a.jsx)(I,{className:"sticky left-0 bg-card z-10 font-medium",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[e.name,t===l&&r<=s&&(0,a.jsx)("span",{title:"Dealer",className:"text-xs font-bold text-accent",children:"(D)"})]})}),n.map(t=>(0,a.jsx)(I,{className:(0,R.cn)("text-center",t===r&&"bg-secondary"),children:(()=>{let s=t-1,r=e.calls[s],l=e.made[s],n=e.scores[s];return 1===t?null!==l?(0,a.jsx)("div",{children:(0,a.jsxs)("span",{className:"font-semibold",children:[n," pts"]})}):"-":null!==r?(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:r}),(0,a.jsx)("span",{children:" / "}),(0,a.jsx)("span",{className:(0,R.cn)(l===r?"text-green-600":"text-destructive"),children:null!==l?l:"Lost"}),(0,a.jsxs)("div",{className:"text-xs font-semibold",children:[n," pts"]})]}):"-"})()},t)),(0,a.jsx)(I,{className:(0,R.cn)("text-center font-bold text-lg",e.totalScore>0&&e.totalScore===i&&"text-accent"),children:(0,a.jsxs)("div",{className:"flex items-center justify-center gap-1",children:[e.totalScore,e.totalScore>0&&e.totalScore===i&&(0,a.jsx)(A.A,{className:"w-4 h-4"})]})})]},e.id))})]})})})})}I.displayName="TableCell",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("caption",{ref:t,className:(0,R.cn)("mt-4 text-sm text-muted-foreground",s),...r})}).displayName="TableCaption";var M=s(6438),z=s(8046),G=s(518),O=s(8376),B=s(4371);let D=e=>{let{value:t,onChange:s,min:r,max:l}=e,n=e=>{e>=r&&e<=l?s(e.toString()):e<r?s(r.toString()):e>l&&s(l.toString())};return(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,a.jsx)(p.$,{type:"button",variant:"outline",size:"icon",className:"h-10 w-10 shrink-0",onClick:()=>{n((""===t?r+1:parseInt(t,10))-1)},disabled:""!==t&&parseInt(t)<=r,children:(0,a.jsx)(M.A,{className:"h-5 w-5"})}),(0,a.jsx)(h.p,{type:"text",inputMode:"numeric",pattern:"[0-9]*",className:"h-12 w-20 text-center text-2xl font-bold",value:t,onChange:e=>{let t=e.target.value;if(""===t)return void s("");let a=parseInt(t.replace(/[^0-9]/g,""),10);!isNaN(a)&&a>=0&&n(a)},onBlur:e=>{let t=parseInt(e.target.value,10);""!==e.target.value&&(isNaN(t)||t<r)&&s(r.toString())},placeholder:"-"}),(0,a.jsx)(p.$,{type:"button",variant:"outline",size:"icon",className:"h-10 w-10 shrink-0",onClick:()=>{n((""===t?r-1:parseInt(t,10))+1)},disabled:""!==t&&parseInt(t)>=l,children:(0,a.jsx)(z.A,{className:"h-5 w-5"})})]})};function V(e){let{round:t,phase:s,players:l,setCalls:n,setMade:i,setOutcomes:d}=e,{toast:o}=(0,y.dj)(),[c,m]=(0,r.useState)(Array(l.length).fill("")),[u,x]=(0,r.useState)(Array(l.length).fill(null)),f=(e,t)=>{let s=[...c];s[e]=t,m(s)},h=(e,t)=>{let s=[...u];s[e]=t,x(s)},j=(0,r.useMemo)(()=>!u.includes(null),[u]),{total:N,isValid:b,validationMessage:w}=(0,r.useMemo)(()=>{let e=c.map(e=>parseInt(e,10)).filter(e=>!isNaN(e)),t=e.reduce((e,t)=>e+t,0),a=c.every(e=>""!==e.trim());return"calling"===s?e.some(e=>e<2)?{total:t,isValid:!1,validationMessage:"Minimum call for any player is 2."}:{total:t,isValid:a&&t>=13,validationMessage:"Total calls must be 13 or more."}:{total:t,isValid:a&&13===t,validationMessage:"Total tricks made must be exactly ".concat(13,".")}},[c,l.length,s]);if("making"===s&&t>1)return(0,a.jsxs)(v.Zp,{className:"shadow-lg",children:[(0,a.jsxs)(v.aR,{children:[(0,a.jsxs)(v.ZB,{children:["Round ",t," - Record Outcomes"]}),(0,a.jsx)(v.BT,{children:"Select whether each player won (made their call) or lost."})]}),(0,a.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!j)return void o({title:"Incomplete",description:"Please select an outcome for every player.",variant:"destructive"});d(u)},children:[(0,a.jsx)(v.Wu,{className:"space-y-2",children:l.map((e,s)=>(0,a.jsxs)("div",{className:"flex justify-between items-center p-2 rounded-lg bg-secondary/50",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:e.name}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Called: ",e.calls[t-1]]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(p.$,{type:"button",variant:"won"===u[s]?"default":"outline",size:"icon",onClick:()=>h(s,"won"),className:(0,R.cn)("won"===u[s]&&"bg-green-600 hover:bg-green-700 text-white"),children:(0,a.jsx)(G.A,{className:"h-5 w-5"})}),(0,a.jsx)(p.$,{type:"button",variant:"lost"===u[s]?"destructive":"outline",size:"icon",onClick:()=>h(s,"lost"),children:(0,a.jsx)(S.A,{className:"h-5 w-5"})})]})]},e.id))}),(0,a.jsx)(v.wL,{children:(0,a.jsx)(p.$,{type:"submit",className:"w-full bg-accent hover:bg-accent/90 text-accent-foreground",disabled:!j,children:"Finish Round"})})]})]});let A="calling"===s;return(0,a.jsxs)(v.Zp,{className:"shadow-lg",children:[(0,a.jsxs)(v.aR,{children:[(0,a.jsxs)(v.ZB,{children:["Round ",t," - ",A?"Make Your Calls":"Record Tricks Made (Round 1)"]}),(0,a.jsx)(v.BT,{children:A?"Each player calls how many tricks they will win. Minimum call is 2. The total must be 13 or more.":"Enter how many tricks each player won. The total must be exactly 13."})]}),(0,a.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!b)return void o({title:"Invalid Input",description:w,variant:"destructive"});let t=c.map(e=>parseInt(e,10));"calling"===s?n(t):i(t)},children:[(0,a.jsxs)(v.Wu,{className:"space-y-3",children:[l.map((e,t)=>(0,a.jsxs)("div",{className:"flex justify-between items-center p-3 rounded-lg bg-card border",children:[(0,a.jsx)(g.J,{htmlFor:"input-".concat(e.id),className:"font-semibold text-base",children:e.name}),(0,a.jsx)(D,{value:c[t],onChange:e=>f(t,e),min:2*!!A,max:13})]},e.id)),(0,a.jsxs)("div",{className:"pt-4 text-center",children:[(0,a.jsxs)("p",{className:"font-bold text-lg",children:["Total: ",N]}),(0,a.jsx)("div",{className:(0,R.cn)("flex items-center justify-center gap-2 transition-opacity",c.some(e=>""!==e)?"opacity-100":"opacity-0"),children:b?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(O.A,{className:"h-5 w-5 text-green-600"}),(0,a.jsx)("span",{className:"text-green-600 font-medium",children:"Valid!"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(B.A,{className:"h-5 w-5 text-destructive"}),(0,a.jsx)("span",{className:"text-destructive font-medium",children:w})]})})]})]}),(0,a.jsx)(v.wL,{children:(0,a.jsx)(p.$,{type:"submit",className:"w-full bg-accent hover:bg-accent/90 text-accent-foreground",disabled:!b,children:A?"Submit Calls":"Finish Round"})})]})]})}var P=s(7948),U=s(6936),Z=s(8027),F=s(1362),J=s(4404),$=s(3158),H=s(154);let q=J.bL,W=J.l9,Y=J.YJ;J.ZL,J.Pb,J.z6,r.forwardRef((e,t)=>{let{className:s,inset:r,children:l,...n}=e;return(0,a.jsxs)(J.ZP,{ref:t,className:(0,R.cn)("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",r&&"pl-8",s),...n,children:[l,(0,a.jsx)($.A,{className:"ml-auto"})]})}).displayName=J.ZP.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(J.G5,{ref:t,className:(0,R.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...r})}).displayName=J.G5.displayName;let K=r.forwardRef((e,t)=>{let{className:s,sideOffset:r=4,...l}=e;return(0,a.jsx)(J.ZL,{children:(0,a.jsx)(J.UC,{ref:t,sideOffset:r,className:(0,R.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...l})})});K.displayName=J.UC.displayName;let Q=r.forwardRef((e,t)=>{let{className:s,inset:r,...l}=e;return(0,a.jsx)(J.q7,{ref:t,className:(0,R.cn)("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",r&&"pl-8",s),...l})});Q.displayName=J.q7.displayName,r.forwardRef((e,t)=>{let{className:s,children:r,checked:l,...n}=e;return(0,a.jsxs)(J.H_,{ref:t,className:(0,R.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),checked:l,...n,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(J.VF,{children:(0,a.jsx)(G.A,{className:"h-4 w-4"})})}),r]})}).displayName=J.H_.displayName,r.forwardRef((e,t)=>{let{className:s,children:r,...l}=e;return(0,a.jsxs)(J.hN,{ref:t,className:(0,R.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...l,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(J.VF,{children:(0,a.jsx)(H.A,{className:"h-2 w-2 fill-current"})})}),r]})}).displayName=J.hN.displayName;let X=r.forwardRef((e,t)=>{let{className:s,inset:r,...l}=e;return(0,a.jsx)(J.JU,{ref:t,className:(0,R.cn)("px-2 py-1.5 text-sm font-semibold",r&&"pl-8",s),...l})});X.displayName=J.JU.displayName;let ee=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(J.wv,{ref:t,className:(0,R.cn)("-mx-1 my-1 h-px bg-muted",s),...r})});function et(){let{setTheme:e}=(0,F.D)();return(0,a.jsxs)(q,{children:[(0,a.jsx)(W,{asChild:!0,children:(0,a.jsxs)(p.$,{variant:"outline",size:"icon",children:[(0,a.jsx)(U.A,{className:"h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"}),(0,a.jsx)(Z.A,{className:"absolute h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"}),(0,a.jsx)("span",{className:"sr-only",children:"Toggle theme"})]})}),(0,a.jsxs)(K,{align:"end",children:[(0,a.jsx)(Q,{onClick:()=>e("light"),children:"Light"}),(0,a.jsx)(Q,{onClick:()=>e("dark"),children:"Dark"}),(0,a.jsx)(Q,{onClick:()=>e("system"),children:"System"})]})]})}function es(e){let{gameState:t,setCalls:s,setMade:l,setOutcomes:n,resetGame:i}=e,{players:d,round:o,totalRounds:c,phase:m,tag:u}=t,[x,f]=(0,r.useState)({width:0,height:0});(0,r.useEffect)(()=>{let e=()=>{f({width:window.innerWidth,height:window.innerHeight})};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let h=(0,r.useMemo)(()=>{if("finished"!==m)return null;let e=Math.max(...d.map(e=>e.totalScore));return d.filter(t=>t.totalScore===e)},[d,m]);return(0,a.jsxs)("div",{className:"space-y-6",children:["finished"===m&&x.width>0&&(0,a.jsx)(P.A,{width:x.width,height:x.height,recycle:!1,numberOfPieces:500,tweenDuration:1e4}),(0,a.jsxs)("header",{className:"flex flex-col md:flex-row justify-between items-center gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(w.A,{className:"w-8 h-8 text-primary"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-primary",children:"BridgeScore"}),u&&(0,a.jsx)("p",{className:"text-muted-foreground",children:u})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(et,{}),(0,a.jsxs)(p.$,{onClick:i,variant:"destructive",size:"sm",children:[(0,a.jsx)(S.A,{className:"mr-2 h-4 w-4"})," Close Game"]})]})]}),(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:d.map(e=>(0,a.jsx)(v.Zp,{children:(0,a.jsxs)(v.aR,{className:"p-2 md:p-4",children:[(0,a.jsx)(v.BT,{children:e.name}),(0,a.jsx)(v.ZB,{className:"text-2xl",children:e.totalScore})]})},e.id))}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,a.jsx)("div",{className:"lg:col-span-2",children:(0,a.jsx)(_,{players:d,totalRounds:c,currentRound:o,dealerIndex:t.dealerIndex})}),(0,a.jsx)("div",{className:"lg:col-span-1",children:"finished"!==m?(0,a.jsx)(V,{round:o,phase:m,players:d,dealerIndex:t.dealerIndex,setCalls:s,setMade:l,setOutcomes:n},"".concat(o,"-").concat(m)):(0,a.jsxs)(v.Zp,{className:"shadow-lg animate-in fade-in",children:[(0,a.jsxs)(v.aR,{children:[(0,a.jsxs)(v.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(A.A,{className:"text-amber-400"}),"Game Over!"]}),(0,a.jsx)(v.BT,{children:h&&h.length>1?"It's a tie!":"The winner is..."})]}),(0,a.jsx)(v.Wu,{children:h&&h.map(e=>(0,a.jsxs)("div",{className:"text-center p-4 bg-secondary rounded-lg",children:[(0,a.jsx)("p",{className:"text-3xl font-bold text-accent",children:e.name}),(0,a.jsxs)("p",{className:"text-lg text-muted-foreground",children:["with ",e.totalScore," points"]})]},e.id))})]})})]})]})}ee.displayName=J.wv.displayName;var ea=s(9051);let er=r.forwardRef((e,t)=>{let{className:s,children:r,...l}=e;return(0,a.jsxs)(ea.bL,{ref:t,className:(0,R.cn)("relative overflow-hidden",s),...l,children:[(0,a.jsx)(ea.LM,{className:"h-full w-full rounded-[inherit]",children:r}),(0,a.jsx)(el,{}),(0,a.jsx)(ea.OK,{})]})});er.displayName=ea.bL.displayName;let el=r.forwardRef((e,t)=>{let{className:s,orientation:r="vertical",...l}=e;return(0,a.jsx)(ea.VM,{ref:t,orientation:r,className:(0,R.cn)("flex touch-none select-none transition-colors","vertical"===r&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===r&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",s),...l,children:(0,a.jsx)(ea.lr,{className:"relative flex-1 rounded-full bg-border"})})});el.displayName=ea.VM.displayName;var en=s(8856),ei=s(1721),ed=s(1394),eo=s(6874),ec=s.n(eo);let em=e=>{var t;let{game:s}=e,r=Math.max(...s.players.map(e=>e.totalScore)),l=s.players.filter(e=>e.totalScore===r),n=l.map(e=>e.name).join(" & ");return(0,a.jsxs)(v.Zp,{className:"shadow-sm flex flex-col",children:[(0,a.jsxs)(v.aR,{children:[s.hostId&&(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2 text-sm text-muted-foreground",children:[(0,a.jsxs)(ed.eu,{className:"h-6 w-6",children:[(0,a.jsx)(ed.BK,{src:null!=(t=s.hostPhotoURL)?t:""}),(0,a.jsx)(ed.q5,{children:(0,a.jsx)(ei.A,{className:"w-4 h-4"})})]}),"Hosted by ",(0,a.jsx)(ec(),{href:"/profile/".concat(s.hostId),className:"font-medium text-foreground hover:underline",children:s.hostName||"Anonymous"})]}),(0,a.jsx)(v.ZB,{className:"text-xl",children:s.tag||"Game"}),(0,a.jsx)(v.BT,{children:new Date(s.finishedAt).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]}),(0,a.jsxs)(v.Wu,{className:"flex-grow",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-4 p-2 bg-secondary rounded-md",children:[(0,a.jsx)(N.A,{className:"w-5 h-5 text-amber-500"}),(0,a.jsxs)("p",{className:"font-semibold",children:[l.length>1?"Winners: ":"Winner: ",n," (",r," pts)"]})]}),(0,a.jsx)("ul",{className:"text-sm text-muted-foreground space-y-2",children:s.players.map(e=>(0,a.jsxs)("li",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{children:e.name}),(0,a.jsx)("span",{className:"font-medium text-foreground",children:e.totalScore})]},e.id))})]})]})};function eu(){let[e,t]=(0,r.useState)([]),[s,l]=(0,r.useState)(!0);return((0,r.useEffect)(()=>{(async()=>{l(!0),t(await d()),l(!1)})()},[]),s)?(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Game History"}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[(0,a.jsx)(en.E,{className:"h-56 w-full rounded-lg"}),(0,a.jsx)(en.E,{className:"h-56 w-full rounded-lg"}),(0,a.jsx)(en.E,{className:"h-56 w-full rounded-lg"})]})]}):0===e.length?(0,a.jsxs)("div",{className:"text-center py-16 bg-secondary/50 rounded-lg",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold",children:"No Public Games"}),(0,a.jsx)("p",{className:"text-muted-foreground mt-2",children:"Log in and complete a game to see its results here."})]}):(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Game History"}),(0,a.jsx)(er,{className:"h-[calc(100vh-25rem)] pr-4",children:(0,a.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:e.map(e=>(0,a.jsx)(em,{game:e},e.id))})})]})}var ex=s(3057),ef=s(2085);let ep=ex.Kq,eh=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(ex.LM,{ref:t,className:(0,R.cn)("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",s),...r})});eh.displayName=ex.LM.displayName;let eg=(0,ef.F)("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),ej=r.forwardRef((e,t)=>{let{className:s,variant:r,...l}=e;return(0,a.jsx)(ex.bL,{ref:t,className:(0,R.cn)(eg({variant:r}),s),...l})});ej.displayName=ex.bL.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(ex.rc,{ref:t,className:(0,R.cn)("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",s),...r})}).displayName=ex.rc.displayName;let eN=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(ex.bm,{ref:t,className:(0,R.cn)("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",s),"toast-close":"",...r,children:(0,a.jsx)(S.A,{className:"h-4 w-4"})})});eN.displayName=ex.bm.displayName;let ey=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(ex.hE,{ref:t,className:(0,R.cn)("text-sm font-semibold",s),...r})});ey.displayName=ex.hE.displayName;let eb=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(ex.VY,{ref:t,className:(0,R.cn)("text-sm opacity-90",s),...r})});function ev(){let{toasts:e}=(0,y.dj)();return(0,a.jsxs)(ep,{children:[e.map(function(e){let{id:t,title:s,description:r,action:l,...n}=e;return(0,a.jsxs)(ej,{...n,children:[(0,a.jsxs)("div",{className:"grid gap-1",children:[s&&(0,a.jsx)(ey,{children:s}),r&&(0,a.jsx)(eb,{children:r})]}),l,(0,a.jsx)(eN,{})]},t)}),(0,a.jsx)(eh,{})]})}eb.displayName=ex.VY.displayName;var ew=s(172),eS=s(4301),eA=s(3503),eR=s(8646),ek=s(5821);let eE=ek.bL,eC=ek.l9,eT=ek.ZL;ek.bm;let eL=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(ek.hJ,{ref:t,className:(0,R.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...r})});eL.displayName=ek.hJ.displayName;let eI=r.forwardRef((e,t)=>{let{className:s,children:r,...l}=e;return(0,a.jsxs)(eT,{children:[(0,a.jsx)(eL,{}),(0,a.jsxs)(ek.UC,{ref:t,className:(0,R.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...l,children:[r,(0,a.jsxs)(ek.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(S.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});eI.displayName=ek.UC.displayName;let e_=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,R.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...s})};e_.displayName="DialogHeader";let eM=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(ek.hE,{ref:t,className:(0,R.cn)("text-lg font-semibold leading-none tracking-tight",s),...r})});eM.displayName=ek.hE.displayName;let ez=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(ek.VY,{ref:t,className:(0,R.cn)("text-sm text-muted-foreground",s),...r})});ez.displayName=ek.VY.displayName;var eG=s(3349);function eO(){var e,t,s;let{user:r,logout:l}=(0,f.A)();return r?(0,a.jsxs)(q,{children:[(0,a.jsx)(W,{asChild:!0,children:(0,a.jsx)(p.$,{variant:"ghost",className:"relative h-8 w-8 rounded-full",children:(0,a.jsxs)(ed.eu,{className:"h-9 w-9",children:[(0,a.jsx)(ed.BK,{src:null!=(e=r.photoURL)?e:"",alt:null!=(t=r.displayName)?t:""}),(0,a.jsx)(ed.q5,{children:(s=r.displayName)?s.split(" ").map(e=>e[0]).join("").toUpperCase():"U"})]})})}),(0,a.jsxs)(K,{className:"w-56",align:"end",forceMount:!0,children:[(0,a.jsx)(X,{className:"font-normal",children:(0,a.jsxs)("div",{className:"flex flex-col space-y-1",children:[(0,a.jsx)("p",{className:"text-sm font-medium leading-none",children:r.displayName}),(0,a.jsx)("p",{className:"text-xs leading-none text-muted-foreground",children:r.email})]})}),(0,a.jsx)(ee,{}),(0,a.jsx)(Y,{children:(0,a.jsx)(ec(),{href:"/profile/".concat(r.uid),children:(0,a.jsxs)(Q,{children:[(0,a.jsx)(ei.A,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Profile"})]})})}),(0,a.jsx)(ee,{}),(0,a.jsxs)(Q,{onClick:l,children:[(0,a.jsx)(eG.A,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Log out"})]})]})]}):null}var eB=s(7104);function eD(){return(0,a.jsx)(ec(),{href:"/login",passHref:!0,children:(0,a.jsxs)(p.$,{children:[(0,a.jsx)(eB.A,{className:"mr-2 h-4 w-4"}),"Login"]})})}var eV=s(5695),eP=s(2250);function eU(){let{gameState:e,...t}=x(),{user:s,loading:l,signInAsGuest:n}=(0,f.A)(),[i,d]=(0,r.useState)(!1),[o,c]=(0,r.useState)(!1),m=(0,eV.useRouter)(),{toast:u}=(0,y.dj)(),[h,g]=(0,r.useState)(!1);(0,r.useEffect)(()=>{d(!0)},[]);let j=async()=>{g(!0);try{let e=s;e||(e=await n());let t=await (0,eP.do)(e);m.push("/online/game/".concat(t))}catch(e){console.error(e),u({title:"Error",description:"Could not create bot game.",variant:"destructive"})}finally{g(!1)}};return!i||l?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-background text-primary",children:[(0,a.jsx)(ew.A,{className:"w-16 h-16 mb-4 animate-spin"}),(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"Loading BridgeScore..."})]}):(0,a.jsxs)("main",{className:"min-h-screen bg-background text-foreground font-body",children:[(0,a.jsx)("div",{className:"container mx-auto p-4 md:p-8",children:e.isGameActive?(0,a.jsx)(es,{gameState:e,...t}):(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("header",{className:"flex flex-col sm:flex-row justify-between items-center gap-4 border-b pb-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(w.A,{className:"w-8 h-8 text-primary"}),(0,a.jsx)("h1",{className:"text-3xl font-bold text-primary",children:"BridgeScore"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)(eE,{open:o,onOpenChange:c,children:[(0,a.jsx)(eC,{asChild:!0,children:(0,a.jsxs)(p.$,{size:"lg",variant:"outline",children:[(0,a.jsx)(eS.A,{className:"mr-2 h-5 w-5"}),"New Offline Game"]})}),(0,a.jsxs)(eI,{className:"sm:max-w-[425px]",children:[(0,a.jsxs)(e_,{children:[(0,a.jsx)(eM,{className:"flex items-center gap-2 text-2xl",children:"Set Up Offline Game"}),(0,a.jsx)(ez,{children:s?"Your game will be saved to your profile upon completion.":"Log in to save your game history."})]}),(0,a.jsx)(b,{startGame:(e,a,r)=>{s?t.startGame(e,a,r,s.uid,s.displayName,s.photoURL):t.startGame(e,a,r),c(!1)}})]})]}),(0,a.jsxs)(p.$,{size:"lg",variant:"outline",onClick:j,disabled:h,children:[h?(0,a.jsx)(ew.A,{className:"mr-2 h-5 w-5 animate-spin"}):(0,a.jsx)(eA.A,{className:"mr-2 h-5 w-5"}),"Play with Bots"]}),(0,a.jsx)(ec(),{href:"/online",children:(0,a.jsxs)(p.$,{size:"lg",className:"bg-accent hover:bg-accent/90 text-accent-foreground",children:[(0,a.jsx)(eR.A,{className:"mr-2 h-5 w-5"}),"Play Online"]})}),(0,a.jsx)(et,{}),s?(0,a.jsx)(eO,{}):(0,a.jsx)(eD,{})]})]}),(0,a.jsx)(eu,{})]})}),(0,a.jsx)(ev,{})]})}},8856:(e,t,s)=>{"use strict";s.d(t,{E:()=>l});var a=s(5155),r=s(9434);function l(e){let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,r.cn)("animate-pulse rounded-md bg-muted",t),...s})}}},e=>{var t=t=>e(e.s=t);e.O(0,[611,644,271,198,649,821,460,7,441,684,358],()=>t(2751)),_N_E=e.O()}]);